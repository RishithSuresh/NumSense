<!DOCTYPE html>
<html lang="en">
<head>
    <title>NumSense - Advanced Number Analysis</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            transition: all 0.3s ease;
        }
        .main-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
        }
        .card {
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 100%;
            max-width: 800px;
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }
        .result {
            font-size: 1.2rem;
            font-weight: 600;
            margin-top: 15px;
        }
        .history {
            margin-top: 20px;
            text-align: left;
        }
        .section-divider {
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, #ddd, transparent);
            margin: 30px 0;
        }
        .feature-section {
            margin: 25px 0;
            padding: 20px;
            border-radius: 15px;
            background: rgba(248, 249, 250, 0.5);
            border: 1px solid rgba(0,0,0,0.05);
        }
        .dark-mode {
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);
            color: #f5f5f5;
        }
        .dark-mode .card {
            background: rgba(30, 30, 30, 0.95);
            color: #f5f5f5;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .dark-mode .feature-section {
            background: rgba(40, 40, 40, 0.5);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .dark-mode .section-divider {
            background: linear-gradient(90deg, transparent, #555, transparent);
        }
        .dark-mode .text-muted {
            color: #cccccc !important;
        }
        .dark-mode ::placeholder {
            color: #aaaaaa !important;
            opacity: 1;
        }
        .dark-mode select.form-select {
            background: #2c2c2c;
            color: #f5f5f5;
            border-color: #555;
        }
        .dark-mode select.form-select option {
            background: #2c2c2c;
            color: #f5f5f5;
        }
        .dark-mode input.form-control {
            background: #2c2c2c;
            color: #f5f5f5;
            border-color: #555;
        }
        .dark-mode input.form-control:focus {
            background: #2c2c2c;
            color: #f5f5f5;
            border-color: #888;
            box-shadow: 0 0 0 0.2rem rgba(130, 138, 145, 0.5);
        }
        .dark-mode input.form-control::placeholder {
            color: #aaaaaa;
            opacity: 1;
        }
        .btn-modern {
            border-radius: 12px;
            font-weight: 500;
            padding: 12px 24px;
            transition: all 0.3s ease;
            border: none;
        }
        .btn-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .number-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-3px);
            background: rgba(255,255,255,0.15);
        }
        .dark-mode .stat-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .dark-mode .stat-card:hover {
            background: rgba(255,255,255,0.1);
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="card p-5 text-center">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1 class="mb-0">🔢 NumSense</h1>
                <button id="toggleMode" class="btn btn-outline-secondary btn-sm">
                    <i class="fa-solid fa-moon"></i> Dark Mode
                </button>
            </div>
            <p class="text-muted mb-4">Discover the hidden identity of your numbers with advanced mathematical analysis</p>
            <form id="numForm">
                <div class="row mb-4">
                    <div class="col-md-8">
                        <div class="input-group">
                            <input type="text" class="form-control form-control-lg" id="number" placeholder="Enter a number" required>
                            <button type="button" class="btn btn-outline-secondary" id="randomBtn" title="Random Number">
                                <i class="fa-solid fa-dice"></i>
                            </button>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <select class="form-select form-select-lg" id="choice">
                            <option value="Palindrome">Palindrome</option>
                            <option value="Prime">Prime</option>
                            <option value="Armstrong">Armstrong</option>
                            <option value="Perfect">Perfect</option>
                            <option value="Fibonacci">Fibonacci</option>
                        </select>
                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col-md-6">
                        <button type="submit" class="btn btn-primary btn-modern w-100">
                            <i class="fa-solid fa-magnifying-glass"></i> Check Number
                        </button>
                    </div>
                    <div class="col-md-6">
                        <button type="button" class="btn btn-success btn-modern w-100" id="checkAllBtn">
                            <i class="fa-solid fa-list-check"></i> Check All Properties
                        </button>
                    </div>
                </div>
            </form>
            <!-- Property Explanation -->
            <div id="propertyExplanation" class="text-muted small mb-3 p-3 rounded" style="background: rgba(108, 117, 125, 0.1);"></div>

            <!-- Result Section -->
            <div id="resultRow" style="display: none;">
                <div class="feature-section">
                    <div id="resultBox" class="alert result mb-3 text-center" style="font-size: 1.2rem; font-weight: 600;"></div>
                    <div id="explanationBox" class="small text-center p-3 rounded" style="background: rgba(108, 117, 125, 0.1); word-break: break-word;"></div>
                </div>
            </div>

            <!-- All Properties Table -->
            <div id="allPropsBox"></div>

            <hr class="section-divider">

            <!-- Number Statistics Feature (NEW) -->
            <div class="feature-section">
                <h5 class="mb-3"><i class="fa-solid fa-chart-pie"></i> Number Statistics</h5>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <input type="number" class="form-control" id="statsNumber" placeholder="Enter number for stats" min="1">
                    </div>
                    <div class="col-md-6">
                        <button class="btn btn-info btn-modern w-100" id="generateStatsBtn">
                            <i class="fa-solid fa-calculator"></i> Generate Stats
                        </button>
                    </div>
                </div>
                <div id="numberStats" class="number-stats"></div>
            </div>

            <hr class="section-divider">

            <!-- History Section -->
            <div class="feature-section">
                <h5 class="mb-3"><i class="fa-solid fa-clock-rotate-left"></i> Recent Checks</h5>
                <ul id="historyList" class="list-unstyled"></ul>
            </div>

            <hr class="section-divider">

            <!-- Visualization Section -->
            <div class="feature-section">
                <h5 class="mb-3"><i class="fa-solid fa-chart-column"></i> Visualize Properties in Range</h5>
                <div class="row mb-3">
                    <div class="col-md-4">
                        <input type="number" class="form-control" id="rangeStart" placeholder="Start" min="1" value="1">
                    </div>
                    <div class="col-md-4">
                        <input type="number" class="form-control" id="rangeEnd" placeholder="End" min="1" value="100">
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-info btn-modern w-100" id="visualizeBtn">
                            <i class="fa-solid fa-chart-column"></i> Visualize
                        </button>
                    </div>
                </div>
                <canvas id="propertyChart" height="200"></canvas>
            </div>
        </div>
    </div>

    <!-- Confetti JS -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Bootstrap + JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const form = document.getElementById("numForm");
        const resultBox = document.getElementById("resultBox");
        const historyList = document.getElementById("historyList");
        let history = [];

        form.addEventListener("submit", function(e) {
            e.preventDefault();

            const number = document.getElementById("number").value;
            const choice = document.getElementById("choice").value;

            // Hide old result row
            document.getElementById("resultRow").style.display = "none";
            let result = "";
            let isPositive = false;
            let explanation = "";
            if (choice === "Palindrome") {
                isPositive = number === number.split("").reverse().join("");
                result = isPositive ? `${number} is a Palindrome ✅` : `${number} is not a Palindrome ❌`;
                explanation = `Reverse of ${number} is ${number.split("").reverse().join("")}.`;
            } else if (choice === "Prime") {
                let n = parseInt(number);
                if (n < 2) {
                    isPositive = false;
                    explanation = `${number} is less than 2.`;
                } else {
                    let divisor = null;
                    for (let i = 2; i <= Math.floor(Math.sqrt(n)); i++) {
                        if (n % i === 0) { divisor = i; break; }
                    }
                    isPositive = divisor === null;
                    explanation = isPositive ? `No divisors found between 2 and ${Math.floor(Math.sqrt(n))}.` : `Divisible by ${divisor}.`;
                }
                result = isPositive ? `${number} is Prime ✅` : `${number} is not Prime ❌`;
            } else if (choice === "Armstrong") {
                let power = number.length;
                let parts = number.split("").map(d => `${d}^${power}=${Math.pow(parseInt(d), power)}`);
                let sum = number.split("").reduce((acc, d) => acc + Math.pow(parseInt(d), power), 0);
                isPositive = sum == number;
                explanation = `${parts.join(' + ')} = ${sum}`;
                result = isPositive ? `${number} is an Armstrong Number ✅` : `${number} is not an Armstrong Number ❌`;
            } else if (choice === "Perfect") {
                let n = parseInt(number);
                let divisors = [];
                for (let i = 1; i < n; i++) if (n % i === 0) divisors.push(i);
                let sum = divisors.reduce((a, b) => a + b, 0);
                isPositive = sum === n;
                explanation = `Divisors: [${divisors.join(', ')}]. Sum = ${sum}`;
                result = isPositive ? `${number} is a Perfect Number ✅` : `${number} is not a Perfect Number ❌`;
            } else if (choice === "Fibonacci") {
                let n = parseInt(number);
                let a = 0, b = 1;
                let seq = [0, 1];
                while (b < n) { a = b; b = a + b; seq.push(b); }
                isPositive = (a === n || b === n);
                explanation = `Fibonacci sequence up to ${number}: [${seq.filter(x => x <= n).join(', ')}]`;
                result = isPositive ? `${number} is a Fibonacci Number ✅` : `${number} is not a Fibonacci Number ❌`;
            }
            document.getElementById("resultBox").textContent = result;
            document.getElementById("explanationBox").textContent = explanation;
            document.getElementById("resultRow").style.display = "flex";
            resultBox.className = "alert result mb-0 animate__animated d-block " + 
                                  (isPositive ? "alert-success animate__bounceIn" : "alert-danger animate__shakeX");
            if (isPositive) {
                const confettiColors = document.body.classList.contains("dark-mode") 
                    ? ['#FFD700', '#FF69B4', '#00FFFF', '#ADFF2F', '#FF4500']
                    : ['#4facfe', '#00f2fe', '#ff7f50', '#32cd32', '#ff1493'];
                confetti({
                    particleCount: 80,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: confettiColors
                });
            }
            history.unshift(result);
            if (history.length > 5) history.pop();
            historyList.innerHTML = history.map(item => `
                <li class="d-flex align-items-center mb-2 p-2 rounded" style="background: rgba(108, 117, 125, 0.1);">
                    <i class="fa-solid fa-clock me-2" style="color: #667eea;"></i>
                    <span class="small">${item}</span>
                </li>
            `).join("");
        });

        const toggleMode = document.getElementById("toggleMode");

        function updateToggleButton() {
            if (document.body.classList.contains("dark-mode")) {
                toggleMode.innerHTML = '<i class="fa-solid fa-sun"></i> Light Mode';
            } else {
                toggleMode.innerHTML = '<i class="fa-solid fa-moon"></i> Dark Mode';
            }
        }

        // Load saved mode
        if (localStorage.getItem("darkMode") === "true") {
            document.body.classList.add("dark-mode");
        }
        updateToggleButton();

        toggleMode.addEventListener("click", () => {
            document.body.classList.toggle("dark-mode");
            localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
            updateToggleButton();
        });

        // --- Check All Properties Feature ---
        document.getElementById("checkAllBtn").addEventListener("click", function() {
            const number = document.getElementById("number").value;
            if (!number || isNaN(number)) {
                document.getElementById("allPropsBox").innerHTML = '<div class="alert alert-danger">Please enter a valid number.</div>';
                return;
            }
            const n = parseInt(number);
            // Palindrome
            const isPal = number === number.split("").reverse().join("");
            // Prime
            const isPrime = n > 1 && Array.from({length: n-2}, (_, i) => i+2).every(x => n % x !== 0);
            // Armstrong
            const armSum = number.split("").reduce((acc, d) => acc + Math.pow(parseInt(d), number.length), 0);
            const isArm = armSum == number;
            // Perfect
            let sum = 0;
            for (let i = 1; i <= n/2; i++) if (n % i === 0) sum += i;
            const isPerf = sum === n;
            // Fibonacci
            let a = 0, b = 1;
            while (a < n) [a, b] = [b, a + b];
            const isFibo = a === n;
            // Table
            const rows = [
                [`Palindrome`, isPal],
                [`Prime`, isPrime],
                [`Armstrong`, isArm],
                [`Perfect`, isPerf],
                [`Fibonacci`, isFibo]
            ].map(([prop, val]) => `<tr><td>${prop}</td><td>${val ? '✅' : '❌'}</td></tr>`).join("");
            document.getElementById("allPropsBox").innerHTML = `
                <table class="table table-bordered table-striped mt-2">
                    <thead><tr><th>Property</th><th>Result</th></tr></thead>
                    <tbody>${rows}</tbody>
                </table>
            `;
        });

        // --- Random Number Generator ---
        document.getElementById("randomBtn").addEventListener("click", function() {
            // Generate a random integer between 1 and 99999
            const rand = Math.floor(Math.random() * 99999) + 1;
            document.getElementById("number").value = rand;
        });

        // --- NEW FEATURE: Number Statistics ---
        document.getElementById("generateStatsBtn").addEventListener("click", function() {
            const number = document.getElementById("statsNumber").value;
            if (!number || isNaN(number) || parseInt(number) < 1) {
                document.getElementById("numberStats").innerHTML = '<div class="alert alert-danger">Please enter a valid positive number.</div>';
                return;
            }

            const n = parseInt(number);
            const digits = number.toString().split('').map(d => parseInt(d));

            // Calculate various statistics
            const digitSum = digits.reduce((a, b) => a + b, 0);
            const digitProduct = digits.reduce((a, b) => a * b, 1);
            const digitCount = digits.length;
            const uniqueDigits = [...new Set(digits)].length;
            const maxDigit = Math.max(...digits);
            const minDigit = Math.min(...digits);
            const isEven = n % 2 === 0;
            const digitAverage = (digitSum / digitCount).toFixed(2);

            // Count divisors
            let divisorCount = 0;
            for (let i = 1; i <= n; i++) {
                if (n % i === 0) divisorCount++;
            }

            // Binary representation
            const binary = n.toString(2);

            const stats = [
                { label: 'Digit Sum', value: digitSum, icon: 'fa-plus' },
                { label: 'Digit Product', value: digitProduct, icon: 'fa-xmark' },
                { label: 'Digit Count', value: digitCount, icon: 'fa-hashtag' },
                { label: 'Unique Digits', value: uniqueDigits, icon: 'fa-star' },
                { label: 'Max Digit', value: maxDigit, icon: 'fa-arrow-up' },
                { label: 'Min Digit', value: minDigit, icon: 'fa-arrow-down' },
                { label: 'Even/Odd', value: isEven ? 'Even' : 'Odd', icon: 'fa-balance-scale' },
                { label: 'Digit Average', value: digitAverage, icon: 'fa-chart-line' },
                { label: 'Divisor Count', value: divisorCount, icon: 'fa-divide' },
                { label: 'Binary', value: binary, icon: 'fa-code' }
            ];

            const statsHTML = stats.map(stat => `
                <div class="stat-card">
                    <i class="fa-solid ${stat.icon} mb-2" style="font-size: 1.2rem; color: #667eea;"></i>
                    <div style="font-size: 0.9rem; color: #666;">${stat.label}</div>
                    <div style="font-size: 1.1rem; font-weight: 600; margin-top: 5px;">${stat.value}</div>
                </div>
            `).join('');

            document.getElementById("numberStats").innerHTML = statsHTML;
        });

        // --- Property Explanations ---
        const propertyExplanation = document.getElementById("propertyExplanation");
        const explanations = {
            Palindrome: "A Palindrome number reads the same backward as forward (e.g., 121, 1331).",
            Prime: "A Prime number is only divisible by 1 and itself (e.g., 2, 3, 5, 7).",
            Armstrong: "An Armstrong number is equal to the sum of its own digits each raised to the power of the number of digits (e.g., 153 = 1³ + 5³ + 3³).",
            Perfect: "A Perfect number is equal to the sum of its proper divisors (e.g., 6 = 1 + 2 + 3).",
            Fibonacci: "A Fibonacci number is a number in the Fibonacci sequence (e.g., 0, 1, 1, 2, 3, 5, 8, ...)."
        };
        function updateExplanation() {
            const val = document.getElementById("choice").value;
            propertyExplanation.textContent = explanations[val] || "";
        }
        document.getElementById("choice").addEventListener("change", updateExplanation);
        updateExplanation();
        // --- Visualization Feature ---
        let chartInstance = null;
        document.getElementById("visualizeBtn").addEventListener("click", function() {
            const start = parseInt(document.getElementById("rangeStart").value);
            const end = parseInt(document.getElementById("rangeEnd").value);
            if (isNaN(start) || isNaN(end) || start < 1 || end < start) {
                alert("Please enter a valid range (start <= end, both > 0)");
                return;
            }
            // Count properties in range
            let counts = {Palindrome:0, Prime:0, Armstrong:0, Perfect:0, Fibonacci:0};
            for (let n = start; n <= end; n++) {
                const s = n.toString();
                // Palindrome
                if (s === s.split("").reverse().join("")) counts.Palindrome++;
                // Prime
                if (n > 1 && Array.from({length: n-2}, (_, i) => i+2).every(x => n % x !== 0)) counts.Prime++;
                // Armstrong
                if (s.split("").reduce((acc, d) => acc + Math.pow(parseInt(d), s.length), 0) == n) counts.Armstrong++;
                // Perfect
                let sum = 0;
                for (let i = 1; i <= n/2; i++) if (n % i === 0) sum += i;
                if (sum === n) counts.Perfect++;
                // Fibonacci
                let a = 0, b = 1;
                while (a < n) [a, b] = [b, a + b];
                if (a === n) counts.Fibonacci++;
            }
            // Draw chart
            const ctx = document.getElementById('propertyChart').getContext('2d');
            if (chartInstance) chartInstance.destroy();
            chartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(counts),
                    datasets: [{
                        label: `Count in [${start}, ${end}]`,
                        data: Object.values(counts),
                        backgroundColor: [
                            '#4facfe', '#00f2fe', '#ff7f50', '#32cd32', '#ff1493'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false },
                        title: { display: true, text: 'Number Properties Distribution' }
                    },
                    scales: {
                        y: { beginAtZero: true, precision:0 }
                    }
                }
            });
        });
    </script>
</body>
</html>
