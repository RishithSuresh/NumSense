<!DOCTYPE html>
<html lang="en">
<head>
    <title>NumSense - Number Checker</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
    <style>
        body { 
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            transition: background 0.7s ease, color 0.7s ease;
        }
        .card {
            border-radius: 15px;
            box-shadow: 0px 6px 20px rgba(0,0,0,0.2);
            max-width: 450px;
            width: 100%;
        }
        .result {
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: 15px;
        }
        .history {
            margin-top: 20px;
            text-align: left;
        }
        .dark-mode {
            background: linear-gradient(135deg, #1a1a2e, #162447);
            color: #f5f5f5;
        }
        .dark-mode .card {
            background: #1e1e1e;
            color: #f5f5f5;
        }
        .dark-mode .text-muted {
            color: #cccccc !important;
        }
        .dark-mode ::placeholder {
            color: #aaaaaa !important;
            opacity: 1;
        }
        .dark-mode select.form-select {
            background: #2c2c2c;
            color: #f5f5f5;
            border-color: #555;
        }
        .dark-mode select.form-select option {
            background: #2c2c2c;
            color: #f5f5f5;
        }
        .dark-mode input.form-control {
            background: #2c2c2c;
            color: #f5f5f5;
            border-color: #555;
        }
        .dark-mode input.form-control:focus {
            background: #2c2c2c;
            color: #f5f5f5;
            border-color: #888;
            box-shadow: none;
        }
        .dark-mode input.form-control::placeholder {
            color: #aaaaaa;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="card p-4 text-center">
        <h2 class="mb-3">🔢 NumSense</h2>
        <p class="text-muted">Discover the hidden identity of your numbers</p>
        
        <!-- Toggle Dark Mode -->
        <button id="toggleMode" class="btn btn-outline-secondary btn-sm mb-3">
            <i class="fa-solid fa-moon"></i> Dark Mode
        </button>

        <form id="numForm">
            <div class="mb-3">
                <div class="input-group">
                    <input type="text" class="form-control" id="number" placeholder="Enter a number" required>
                    <button type="button" class="btn btn-outline-secondary" id="randomBtn" title="Random Number">
                        <i class="fa-solid fa-dice"></i>
                    </button>
                </div>
            </div>
            <div class="mb-3">
                <select class="form-select" id="choice">
                    <option value="Palindrome">Palindrome</option>
                    <option value="Prime">Prime</option>
                    <option value="Armstrong">Armstrong</option>
                    <option value="Perfect">Perfect</option>
                    <option value="Fibonacci">Fibonacci</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary w-100">
                <i class="fa-solid fa-magnifying-glass"></i> Check Number
            </button>
            <button type="button" class="btn btn-success w-100 mt-2" id="checkAllBtn">
                <i class="fa-solid fa-list-check"></i> Check All Properties
            </button>
    </form>

    <!-- Property Explanation -->
    <div id="propertyExplanation" class="text-muted small mt-2 mb-2"></div>
        </form>

        <!-- Result Section -->
        <div id="resultBox" class="alert result mt-4 d-none"></div>

    <!-- All Properties Table -->
    <div id="allPropsBox" class="mt-3"></div>

        <!-- History Section -->
        <div class="history">
            <h6>Recent Checks:</h6>
            <ul id="historyList" class="list-unstyled small"></ul>
        </div>
        <!-- Visualization Section -->
        <div class="mt-4">
            <h6>Visualize Properties in a Range</h6>
            <div class="input-group mb-2">
                <input type="number" class="form-control" id="rangeStart" placeholder="Start" min="1" value="1">
                <input type="number" class="form-control" id="rangeEnd" placeholder="End" min="1" value="100">
                <button class="btn btn-info" id="visualizeBtn"><i class="fa-solid fa-chart-column"></i> Visualize</button>
            </div>
            <canvas id="propertyChart" height="180"></canvas>
        </div>
    </div>

    <!-- Confetti JS -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Bootstrap + JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const form = document.getElementById("numForm");
        const resultBox = document.getElementById("resultBox");
        const historyList = document.getElementById("historyList");
        let history = [];

        form.addEventListener("submit", function(e) {
            e.preventDefault();

            const number = document.getElementById("number").value;
            const choice = document.getElementById("choice").value;

            let result = "";
            let isPositive = false;

            if (choice === "Palindrome") {
                isPositive = number === number.split("").reverse().join("");
                result = isPositive ? `${number} is a Palindrome ✅` : `${number} is not a Palindrome ❌`;
            } else if (choice === "Prime") {
                let n = parseInt(number);
                isPositive = n > 1 && Array.from({length: n-2}, (_, i) => i+2).every(x => n % x !== 0);
                result = isPositive ? `${number} is Prime ✅` : `${number} is not Prime ❌`;
            } else if (choice === "Armstrong") {
                let sum = number.split("").reduce((acc, d) => acc + Math.pow(parseInt(d), number.length), 0);
                isPositive = sum == number;
                result = isPositive ? `${number} is an Armstrong Number ✅` : `${number} is not an Armstrong Number ❌`;
            } else if (choice === "Perfect") {
                let n = parseInt(number);
                let sum = 0;
                for (let i = 1; i <= n/2; i++) if (n % i === 0) sum += i;
                isPositive = sum === n;
                result = isPositive ? `${number} is a Perfect Number ✅` : `${number} is not a Perfect Number ❌`;
            } else if (choice === "Fibonacci") {
                let n = parseInt(number);
                let a = 0, b = 1;
                while (a < n) {
                    [a, b] = [b, a + b];
                }
                isPositive = a === n;
                result = isPositive ? `${number} is a Fibonacci Number ✅` : `${number} is not a Fibonacci Number ❌`;
            }

            resultBox.textContent = result;
            resultBox.className = "alert result mt-4 animate__animated d-block " + 
                                  (isPositive ? "alert-success animate__bounceIn" : "alert-danger animate__shakeX");

            if (isPositive) {
                const confettiColors = document.body.classList.contains("dark-mode") 
                    ? ['#FFD700', '#FF69B4', '#00FFFF', '#ADFF2F', '#FF4500']
                    : ['#4facfe', '#00f2fe', '#ff7f50', '#32cd32', '#ff1493'];

                confetti({
                    particleCount: 80,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: confettiColors
                });
            }

            history.unshift(result);
            if (history.length > 5) history.pop();
            historyList.innerHTML = history.map(item => `<li>• ${item}</li>`).join("");
        });

        const toggleMode = document.getElementById("toggleMode");

        function updateToggleButton() {
            if (document.body.classList.contains("dark-mode")) {
                toggleMode.innerHTML = '<i class="fa-solid fa-sun"></i> Light Mode';
            } else {
                toggleMode.innerHTML = '<i class="fa-solid fa-moon"></i> Dark Mode';
            }
        }

        // Load saved mode
        if (localStorage.getItem("darkMode") === "true") {
            document.body.classList.add("dark-mode");
        }
        updateToggleButton();

        toggleMode.addEventListener("click", () => {
            document.body.classList.toggle("dark-mode");
            localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
            updateToggleButton();
        });

        // --- Check All Properties Feature ---
        document.getElementById("checkAllBtn").addEventListener("click", function() {
            const number = document.getElementById("number").value;
            if (!number || isNaN(number)) {
                document.getElementById("allPropsBox").innerHTML = '<div class="alert alert-danger">Please enter a valid number.</div>';
                return;
            }
            const n = parseInt(number);
            // Palindrome
            const isPal = number === number.split("").reverse().join("");
            // Prime
            const isPrime = n > 1 && Array.from({length: n-2}, (_, i) => i+2).every(x => n % x !== 0);
            // Armstrong
            const armSum = number.split("").reduce((acc, d) => acc + Math.pow(parseInt(d), number.length), 0);
            const isArm = armSum == number;
            // Perfect
            let sum = 0;
            for (let i = 1; i <= n/2; i++) if (n % i === 0) sum += i;
            const isPerf = sum === n;
            // Fibonacci
            let a = 0, b = 1;
            while (a < n) [a, b] = [b, a + b];
            const isFibo = a === n;
            // Table
            const rows = [
                [`Palindrome`, isPal],
                [`Prime`, isPrime],
                [`Armstrong`, isArm],
                [`Perfect`, isPerf],
                [`Fibonacci`, isFibo]
            ].map(([prop, val]) => `<tr><td>${prop}</td><td>${val ? '✅' : '❌'}</td></tr>`).join("");
            document.getElementById("allPropsBox").innerHTML = `
                <table class="table table-bordered table-striped mt-2">
                    <thead><tr><th>Property</th><th>Result</th></tr></thead>
                    <tbody>${rows}</tbody>
                </table>
            `;
        });

        // --- Random Number Generator ---
        document.getElementById("randomBtn").addEventListener("click", function() {
            // Generate a random integer between 1 and 99999
            const rand = Math.floor(Math.random() * 99999) + 1;
            document.getElementById("number").value = rand;
        });

        // --- Property Explanations ---
        const propertyExplanation = document.getElementById("propertyExplanation");
        const explanations = {
            Palindrome: "A Palindrome number reads the same backward as forward (e.g., 121, 1331).",
            Prime: "A Prime number is only divisible by 1 and itself (e.g., 2, 3, 5, 7).",
            Armstrong: "An Armstrong number is equal to the sum of its own digits each raised to the power of the number of digits (e.g., 153 = 1³ + 5³ + 3³).",
            Perfect: "A Perfect number is equal to the sum of its proper divisors (e.g., 6 = 1 + 2 + 3).",
            Fibonacci: "A Fibonacci number is a number in the Fibonacci sequence (e.g., 0, 1, 1, 2, 3, 5, 8, ...)."
        };
        function updateExplanation() {
            const val = document.getElementById("choice").value;
            propertyExplanation.textContent = explanations[val] || "";
        }
        document.getElementById("choice").addEventListener("change", updateExplanation);
        updateExplanation();
        // --- Visualization Feature ---
        let chartInstance = null;
        document.getElementById("visualizeBtn").addEventListener("click", function() {
            const start = parseInt(document.getElementById("rangeStart").value);
            const end = parseInt(document.getElementById("rangeEnd").value);
            if (isNaN(start) || isNaN(end) || start < 1 || end < start) {
                alert("Please enter a valid range (start <= end, both > 0)");
                return;
            }
            // Count properties in range
            let counts = {Palindrome:0, Prime:0, Armstrong:0, Perfect:0, Fibonacci:0};
            for (let n = start; n <= end; n++) {
                const s = n.toString();
                // Palindrome
                if (s === s.split("").reverse().join("")) counts.Palindrome++;
                // Prime
                if (n > 1 && Array.from({length: n-2}, (_, i) => i+2).every(x => n % x !== 0)) counts.Prime++;
                // Armstrong
                if (s.split("").reduce((acc, d) => acc + Math.pow(parseInt(d), s.length), 0) == n) counts.Armstrong++;
                // Perfect
                let sum = 0;
                for (let i = 1; i <= n/2; i++) if (n % i === 0) sum += i;
                if (sum === n) counts.Perfect++;
                // Fibonacci
                let a = 0, b = 1;
                while (a < n) [a, b] = [b, a + b];
                if (a === n) counts.Fibonacci++;
            }
            // Draw chart
            const ctx = document.getElementById('propertyChart').getContext('2d');
            if (chartInstance) chartInstance.destroy();
            chartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(counts),
                    datasets: [{
                        label: `Count in [${start}, ${end}]`,
                        data: Object.values(counts),
                        backgroundColor: [
                            '#4facfe', '#00f2fe', '#ff7f50', '#32cd32', '#ff1493'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false },
                        title: { display: true, text: 'Number Properties Distribution' }
                    },
                    scales: {
                        y: { beginAtZero: true, precision:0 }
                    }
                }
            });
        });
    </script>
</body>
</html>
