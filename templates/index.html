<!DOCTYPE html>
<html lang="en">
<head>
    <title>NumSense - Number Checker</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
    <style>
        body { 
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            transition: background 0.3s, color 0.3s;
        }
        .card {
            border-radius: 15px;
            box-shadow: 0px 6px 20px rgba(0,0,0,0.2);
            max-width: 450px;
            width: 100%;
        }
        .result {
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: 15px;
        }
        .history {
            margin-top: 20px;
            text-align: left;
        }
        .dark-mode {
            background: #121212;
            color: #f5f5f5;
        }
        .dark-mode .card {
            background: #1e1e1e;
            color: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="card p-4 text-center">
        <h2 class="mb-3">沐｢ NumSense</h2>
        <p class="text-muted">Discover the hidden identity of your numbers</p>
        
        <!-- Toggle Dark Mode -->
        <button id="toggleMode" class="btn btn-outline-secondary btn-sm mb-3">
            <i class="fa-solid fa-moon"></i> Toggle Dark Mode
        </button>

        <form id="numForm">
            <div class="mb-3">
                <input type="text" class="form-control" id="number" placeholder="Enter a number" required>
            </div>
            <div class="mb-3">
                <select class="form-select" id="choice">
                    <option value="Palindrome">Palindrome</option>
                    <option value="Prime">Prime</option>
                    <option value="Armstrong">Armstrong</option>
                    <option value="Perfect">Perfect</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary w-100">
                <i class="fa-solid fa-magnifying-glass"></i> Check Number
            </button>
        </form>

        <!-- Result Section -->
        <div id="resultBox" class="alert result mt-4 d-none"></div>

        <!-- History Section -->
        <div class="history">
            <h6>Recent Checks:</h6>
            <ul id="historyList" class="list-unstyled small"></ul>
        </div>
    </div>

    <!-- Confetti JS -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- Bootstrap + JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const form = document.getElementById("numForm");
        const resultBox = document.getElementById("resultBox");
        const historyList = document.getElementById("historyList");
        let history = [];

        form.addEventListener("submit", function(e) {
            e.preventDefault();

            const number = document.getElementById("number").value;
            const choice = document.getElementById("choice").value;

            // Simulate backend check (replace with fetch to Flask later)
            let result = "";
            let isPositive = false;

            if (choice === "Palindrome") {
                isPositive = number === number.split("").reverse().join("");
                result = isPositive ? `${number} is a Palindrome 笨` : `${number} is not a Palindrome 笶形;
            } else if (choice === "Prime") {
                let n = parseInt(number);
                isPositive = n > 1 && Array.from({length: n-2}, (_, i) => i+2).every(x => n % x !== 0);
                result = isPositive ? `${number} is Prime 笨` : `${number} is not Prime 笶形;
            } else if (choice === "Armstrong") {
                let sum = number.split("").reduce((acc, d) => acc + Math.pow(parseInt(d), number.length), 0);
                isPositive = sum == number;
                result = isPositive ? `${number} is an Armstrong Number 笨` : `${number} is not an Armstrong Number 笶形;
            } else if (choice === "Perfect") {
                let n = parseInt(number);
                let sum = 0;
                for (let i = 1; i <= n/2; i++) if (n % i === 0) sum += i;
                isPositive = sum === n;
                result = isPositive ? `${number} is a Perfect Number 笨` : `${number} is not a Perfect Number 笶形;
            }

            // Show result
            resultBox.textContent = result;
            resultBox.className = "alert result mt-4 animate__animated d-block " + 
                                  (isPositive ? "alert-success animate__bounceIn" : "alert-danger animate__shakeX");

            // Fire confetti on success
            if (isPositive) {
                confetti({ particleCount: 80, spread: 70, origin: { y: 0.6 } });
            }

            // Save to history
            history.unshift(result);
            if (history.length > 5) history.pop();
            historyList.innerHTML = history.map(item => `<li>窶｢ ${item}</li>`).join("");
        });

        // Dark mode toggle (persistent)
        const toggleMode = document.getElementById("toggleMode");
        toggleMode.addEventListener("click", () => {
            document.body.classList.toggle("dark-mode");
            localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
        });

        // Load saved mode
        if (localStorage.getItem("darkMode") === "true") {
            document.body.classList.add("dark-mode");
        }
    </script>
</body>
</html>
